<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>坪數＋浪板＋斜切＋C型鋼 計算器</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f7f7;
      padding: 30px;
      text-align: center;
    }
    .box {
      background: white;
      padding: 25px;
      margin: 20px auto;
      width: 90%;
      max-width: 600px;
      border-radius: 10px;
      box-shadow: 0px 0px 10px #ddd;
    }
    input, select {
      padding: 10px;
      margin: 5px;
      width: 160px;
      font-size: 16px;
      text-align: center;
    }
    .result {
      margin-top: 15px;
      font-size: 18px;
      font-weight: bold;
      color: #0055cc;
    }
    label {
      font-size: 15px;
      margin-right: 5px;
    }
  </style>
</head>
<body>

<h1>坪數 + 浪板 + 斜切 + C型鋼 計算器</h1>

<!-- 坪數計算 -->
<div class="box">
  <h2>坪數計算</h2>
  <input type="number" id="len" placeholder="長 (cm)" oninput="calcPing()">
  <input type="number" id="wid" placeholder="寬 (cm)" oninput="calcPing()">
  <div id="pingResult" class="result">請輸入長寬</div>
</div>

<!-- 浪板片數 -->
<div class="box">
  <h2>浪板片數計算（750型）</h2>
  <select id="slopeType" onchange="calcWave()">
    <option value="1">單斜</option>
    <option value="2">雙斜（自動 ×2）</option>
  </select>
  <br>
  <input type="number" id="roofLen" placeholder="單邊屋頂長度 (cm)" oninput="calcWave()">
  <div id="waveResult" class="result">請輸入資料</div>
</div>

<!-- 斜切計算器（移到這邊）-->
<div class="box">
  <h2>斜切計算器</h2>
  <input type="number" id="fenShui" step="0.01" placeholder="請輸入分水">
  <select id="liaoKuan">
    <option value="10">10 cm</option>
    <option value="12.5" selected>12.5 cm</option>
  </select>
  <br>
  <input type="number" id="bottom" step="0.1" placeholder="請輸入底長 (cm)">
  <br>
  <input type="number" id="centerH" step="0.1" placeholder="自動計算中心高 (cm)" readonly>
  <br>
  <button onclick="calc()">計算斜切</button>
  <div id="result" class="result">請輸入所有欄位，點選計算。</div>
</div>

<!-- C型鋼計算（移到斜切計算器後面） -->
<div class="box">
  <h2>C 型鋼間距計算（60～80 cm）</h2>
  <input type="number" id="cLen" placeholder="斜樑總長 (cm)" oninput="calcC()">
  <br>
  <label>首隻間距（固定）</label>
  <input type="number" value="15" id="firstGap" readonly>
  <div id="cResult" class="result">請輸入資料</div>
</div>

<script>
function calcPing() {
  let L = parseFloat(document.getElementById("len").value);
  let W = parseFloat(document.getElementById("wid").value);
  if (isNaN(L) || isNaN(W)) {
    document.getElementById("pingResult").innerHTML = "請輸入長寬";
    return;
  }
  let cm2 = L * W;
  let m2 = cm2 / 10000;
  let ping = cm2 / 33057.85;
  document.getElementById("pingResult").innerHTML = `約 ${ping.toFixed(2)} 坪（${m2.toFixed(2)} m²）`;
}

function calcWave() {
  let type = parseInt(document.getElementById("slopeType").value);
  let L = parseFloat(document.getElementById("roofLen").value);
  if (isNaN(L)) {
    document.getElementById("waveResult").innerHTML = "請輸入資料";
    return;
  }
  let pcs = Math.ceil(L / 75);
  if (type === 2) pcs *= 2;
  document.getElementById("waveResult").innerHTML = `需要浪板：${pcs} 片`;
}

function calc() {
  const fenShuiVal = parseFloat(document.getElementById("fenShui").value);
  const liaoKuanVal = parseFloat(document.getElementById("liaoKuan").value);
  const bottomVal = parseFloat(document.getElementById("bottom").value);
  const centerHInput = document.getElementById("centerH");
  const result = document.getElementById("result");

  if (isNaN(fenShuiVal) || isNaN(liaoKuanVal) || isNaN(bottomVal)) {
    result.innerHTML = "請輸入分水、料寬和底長";
    centerHInput.value = "";
    return;
  }

  const angleRad = Math.atan(fenShuiVal / 10);
  const angleDeg = angleRad * 180 / Math.PI;
  const centerHVal = bottomVal * Math.tan(angleRad);
  centerHInput.value = centerHVal.toFixed(2);
  const slopeLen = Math.sqrt(bottomVal * bottomVal + centerHVal * centerHVal);
  const delta = liaoKuanVal * Math.tan(angleRad);
  const cutLen = liaoKuanVal / Math.cos(angleRad);
  const halfCut = delta / 2;

  result.innerHTML =
    `<p>坡度角度：<b>${angleDeg.toFixed(2)}°</b></p>
     <p>計算高度（中心高）：<b>${centerHVal.toFixed(2)} cm</b></p>
     <p>屋頂斜長：<b>${slopeLen.toFixed(2)} cm</b></p>
     <p>端面切量 Δ（垂直落差）：<b>${delta.toFixed(2)} cm</b></p>
     <p>料寬斜切長（沿斜面）：<b>${cutLen.toFixed(2)} cm</b></p>
     <p>中脊左右各切：<b>${halfCut.toFixed(2)} cm</b></p>`;
}

function calcC() {
  let total = parseFloat(document.getElementById("cLen").value);
  let firstGap = 15;
  let resultDiv = document.getElementById("cResult");

  if (isNaN(total) || total <= firstGap) {
    resultDiv.innerHTML = "請輸入大於首隻間距的有效斜樑總長";
    return;
  }

  let usable = total - firstGap;
  let txt = `總長：${total} cm（已扣首隻 ${firstGap} cm）<br><br>`;
  let found = false;

  for (let n = 2; n <= 1000; n++) {
    let segments = n - 1;
    let space = usable / segments;

    if (space >= 60 && space <= 80) {
      found = true;
      txt += `${usable} / ${segments} 隻 = ${space.toFixed(1)} cm　（共 ${n} 隻）<br>`;
    }
    if (space < 60) break;
  }

  if (!found) {
    txt = "沒有符合 60～80 cm 的分佈";
  }
  resultDiv.innerHTML = txt;
}
</script>

</body>
</html>
